services:
  # !! Backend services
  backend-users-api:
    build: ./BackEndService/users_api
    ports:
      - "8080:8080"
    # restart: on-failure
    networks:
      - taxarific
  email-service:
    build: ./BackEndService/email_service
    ports:
      - "8081:8081"
    restart: on-failure
    depends_on:
      - kafka
      - zookeeper
    networks:
      - taxarific

  # !! Outside services
  kafka:
    image: bitnami/kafka:latest
    ports:
      - "9092"
    environment:
      - KAFKA_CFG_ZOOKEEPER_CONNECT=zookeeper:2181
    volumes:
      - kafka_data:/bitnami
    depends_on:
      - zookeeper
    restart: on-failure
    networks:
      - taxarific
  zookeeper:
    image: bitnami/zookeeper:latest
    ports:
      - "2181"
    environment:
      - ALLOW_ANONYMOUS_LOGIN=yes
    volumes:
      - zoo_data:/bitnami
    restart: on-failure
    networks:
      - taxarific

  # !! Frontend service
  frontend-service:
    build: ./FrontEndService
    ports:
      - "3000:3000"
    restart: on-failure
    networks:
      - taxarific
volumes:
  kafka_data: {}
  zoo_data: {}
networks:
  taxarific:
    driver: bridge
