<!DOCTYPE html>
<html id="wholePage" lang="en">
    <head>
    <script type="text/javascript" src="https://cdn.tailwindcss.com"></script>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
        <script src="https://unpkg.com/htmx.org@1.7.0"></script>
        <script src="https://unpkg.com/htmx.org@1.9.12/dist/ext/json-enc.js"></script>
        <title>TaxarificHomePage</title>
    </head>

    <body class="bg-[#816C61] flex flex-col h-screen justify-between">
        <header class="bg-[#2a2c24] text-[#cfcfea]">
            <div id="headerdiv" class="container mx-auto ">
                <nav class="container mx-auto px-4 py-4 flex items-center justify-between">
                    <a href="/" class="mx-2 font-bold">Taxarific</a>
                    <div id="AcssesableActionsDiv">
                    </div>
                    <div id="loginDiv">
                        <a hx-get="/login" hx-target="#mainDiv" class="mx-2">Login</a>
                        <a class="mx-2"> / </a>
                        <a hx-get="/signup" hx-target="#mainDiv" class="mx-2">Sign Up</a>
                    </div>
                </nav>
            </div>
        </header>

        <main id="mainContent">
            <div id="mainDiv" class="bg-[#A89B9D] p-6 rounded-lg shadow-md max-w-lg mx-auto my-5">
                <h2 class="text-2xl font-bold text-center">Log in</h2>
                <p class="text-center">Please login to access your admin account</p>
                <div class="container py-10 px-10 mx-0 min-w-full flex flex-col items-center">
                    <form id="loginForm">
                        <div class="mb-6">
                            <label class="block mb-4 text-[#2A2C24] font-bold">Email</label>
                            <input class="w-full font-bold py-2 px-3 rounded bg-[#cfcfea]" type="email" name="email" required>
                        </div>
                        <div class="mb-6">
                            <label class="block mb-4 text-[#2A2C24] font-bold">Password</label>
                            <input class="w-full font-bold py-2 px-3 rounded bg-[#cfcfea]" type="password" name="password" required>
                            <input class="hidden" type="text" name="role" value="admin">
                        </div>
                        <button class="bg-[#575A4B] hover:bg-[#A89B9D] hover:text-[#2A2C24] text-[#CFCFEA] font-bold py-2 px-4 rounded" type="submit" hx-post="/login" hx-target="#auth-message" hx-include="#loginForm">Log in</button>
                    </form>
                    <div id="auth-message" class="mb-4"></div>
                </div>
            </div>
            <script>
                document.body.addEventListener('htmx:afterRequest', function(evt) {
                    if (evt.detail.target === document.getElementById('auth-message')) {
                        handleAuthResponse(evt, 'Login');
                    }
                });
                
                function handleAuthResponse(evt, action) {
                    var authMessage = document.getElementById('auth-message');
                    if (evt.detail.xhr.status >= 200 && evt.detail.xhr.status < 300) {
                        // No need to set the cookie on the frontend if the backend does it
                        window.location = "/"
                        window.location.reload();  // Refresh the page on success
                    } else {
                        authMessage.textContent = 'Error: ' + evt.detail.xhr.responseText;
                        authMessage.classList.remove('text-green-500');
                        authMessage.classList.add('text-red-500');
                    }
                }
            </script>
            
        </main>

        <footer class="bg-[#2a2c24] text-[#cfcfea]">
            <div class="container mx-auto mt-8">
                <p class="text-center">2024 Taxarific . No rights reserved.</p>
            </div>
    </body>
</html> 